citation(ggpubr)
library(ggpubr)
library(ggpubr)
citation(ggpubr)
citation("ggpubr")
setwd("C:/Users/astra/OneDrive - University of Canterbury/Git/ADPE_Remote_Sensing/Data")
masterdata <- read.csv("ADPE_masterdata.csv")
Dataset.5.0 <- masterdata
Dataset.5.0$logGuano_area <- log(Dataset.5.0$Guano_area)
Dataset.5.0$logBP <- log(Dataset.5.0$BP)
# Extracting only needed variables
Dataset.5.1 <- Dataset.5.0[,c("logBP", "logGuano_area", "Site_ID", "Colony")]
# Remove NAs
Dataset.5.2 <- na.omit(Dataset.5.1)
New.model <- lm(Dataset.5.2$logGuano_area ~ Dataset.5.2$logBP)
summary(New.model)
AIC(New.model)
library(MuMIn) # for AICc scores
BP.AICc <- AICc(New.model)
library(lme4)
# LMM with site effect using REML
lmm1 <- lme4::lmer(logGuano_area ~ logBP + (1|Site_ID), data = Dataset.5.2)
anova(lmm1) # just looks at fixed effects
summary(lmm1) # variances came from here
# Compare LMM to LM using ML method
lmm2 <- lme4::lmer(logGuano_area ~ logBP + (1|Site_ID), REML = FALSE, data = Dataset.5.2)
anova(lmm2) # just looks at fixed effects
summary(lmm2)
AIC(New.model, lmm2)
AICc(New.model, lmm2)
BP.AICc <- AICc(New.model) # parsimonious model
lmm2.AICc <- AICc(lmm2) # model with site effect
library(car) # for VIF values
# Removed from further analysis - Candidate model with northness (correlated with BP)
lm.GA.a1 <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$Northness)
summary(lm.GA.a1)
vif(lm.GA.a1) # well above 2.0
# removed BP
lm.GA.a2 <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$Northness)
summary(lm.GA.a2) # northness does have an influence - not as good as BP
# Candidate model with slope
lm.GA.b <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$Slope)
summary(lm.GA.b)
# Convert degrees to radians
Dataset.5.0$AspectRadians <- pi*Dataset.5.0$Aspect/180
# Calculate northness
Dataset.5.0$Northness <- cos(Dataset.5.0$AspectRadians)
# Extracting extra needed variables
Dataset.5.3 <- Dataset.5.0[,c("logBP", "logGuano_area", "Site_ID", "PAR", "Slope", "Northness")]
# Remove NAs
Dataset.5.4 <- na.omit(Dataset.5.3)
library(car) # for VIF values
# Removed from further analysis - Candidate model with northness (correlated with BP)
lm.GA.a1 <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$Northness)
summary(lm.GA.a1)
vif(lm.GA.a1) # well above 2.0
# removed BP
lm.GA.a2 <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$Northness)
summary(lm.GA.a2) # northness does have an influence - not as good as BP
# Candidate model with slope
lm.GA.b <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$Slope)
summary(lm.GA.b)
anova(lm.GA.b)
vif(lm.GA.b) # both under 2.0
AIC(New.model, lm.GA.b) # over fit? due to low sample size try AICc
AICc(New.model, lm.GA.b) # model without slope better
# Removed from further analysis - Candidate model with northness and slope (have to remove northness)
lm.GA.c <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$Northness + Dataset.5.4$Slope)
summary(lm.GA.c)
vif(lm.GA.c) # only slope under 2.0
# Candidate model with PAR (PAR and BP slightly correlated)
lm.GA.d <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$PAR)
summary(lm.GA.d)
anova(lm.GA.d)
vif(lm.GA.d) # both under 2.0 (Don't need to remove PAR)
AIC(New.model, lm.GA.d) # model without PAR better
AICc(New.model, lm.GA.d) # model without PAR better
# Candidate model with PAR and slope
lm.GA.e <- lm(Dataset.5.4$logGuano_area ~ Dataset.5.4$logBP + Dataset.5.4$PAR + Dataset.5.4$Slope)
summary(lm.GA.e)
anova(lm.GA.e)
vif(lm.GA.e) # all under 2.0
AIC(New.model, lm.GA.e) # model without PAR and slope better
AICc(New.model, lm.GA.e) # model without PAR and slope better
# Intercept only model
null.model <- lm(Dataset.5.4$logGuano_area ~ 1)
BP.AICc <- AICc(New.model) # BP only model
Slope.AICc <- AICc(lm.GA.b) # slope model
PAR.AICc <- AICc(lm.GA.d) # PAR model
Slope.PAR.AICc <- AICc(lm.GA.e) # slope and PAR model
null.AICc <- AICc(null.model) # intercept only model
BP.AICc-null.AICc
BP.AICc-Slope.AICc
BP.AICc-PAR.AICc
BP.AICc-Slope.PAR.AICc
# calculate delta AICc scores and weights
library(qpcR) # package masks MuMin so run after
# for candidate models
x <- c(BP.AICc, Slope.AICc, PAR.AICc, Slope.PAR.AICc, null.AICc)
akaike.weights(x)
# for site effect
x <- c(BP.AICc, lmm2.AICc)
akaike.weights(x)
# Likelihood ratio test (results not reported in the manuscript)
library(lmtest)
# with the full model first
lrtest(lm.GA.e, lm.GA.b, lm.GA.d, New.model, null.model)
# with the full model first
lrtest(lm.GA.e, lm.GA.b, lm.GA.d, New.model)
# compare above model 1 to 2, 3, and 4
lrtest(lm.GA.e, lm.GA.b)
# compare above model 1 to 2, 3, and 4
lrtest(lm.GA.e, lm.GA.b)
lrtest(lm.GA.e, lm.GA.d)
lrtest(lm.GA.e, New.model)
# compare above model 2 to 3 and 4
lrtest(lm.GA.b, lm.GA.d)
lrtest(lm.GA.b, New.model)
# compare above model 3 to 4
lrtest(lm.GA.d, New.model)
# compare above model 1 to 2, 3, and 4
lrtest(lm.GA.e, lm.GA.b) #
lrtest(lm.GA.e, lm.GA.d) #
lrtest(lm.GA.e, New.model) #
# compare above model 2 to 3 and 4
lrtest(lm.GA.b, lm.GA.d) # <0.01
lrtest(lm.GA.b, New.model) # 0.12
# compare above model 3 to 4
lrtest(lm.GA.d, New.model) # 0.49
# start with the full model first
lrtest(lm.GA.e, lm.GA.b, lm.GA.d, New.model)
# compare above model 1 to 2, 3, and 4
lrtest(lm.GA.e, lm.GA.b) # 0.50
lrtest(lm.GA.e, lm.GA.d) # 0.12
lrtest(lm.GA.e, New.model) # 0.24
# compare above model 2 to 3 and 4
lrtest(lm.GA.b, lm.GA.d) # <0.01
lrtest(lm.GA.b, New.model) # 0.12
# compare above model 3 to 4
lrtest(lm.GA.d, New.model) # 0.49
sessionInfo() # for citing package versions
library(DHARMa)
sessionInfo() # for citing package versions
citation("MuMIn")
